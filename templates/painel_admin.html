{% extends 'base.html' %}

{% block conteudo %}
<h1>Painel de Administra칞칚o</h1>

<!-- Resumo R치pido -->
<div>
    <h2>Resumo</h2>
    <ul>
        <li>Total de usu치rios: {{ usuarios | length }}</li>
        <li>Bloqueados: {{ usuarios | selectattr('is_locked') | list | length }}</li>
    </ul>
</div>

<!-- Tabela de Usu치rios -->
<div>
    <h2>Usu치rios</h2>
    <table border="1" cellpadding="5">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome de Usu치rio</th>
                <th>Status</th>
                <th>A칞칚o</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in usuarios %}
            <tr>
                <td>{{ usuario.id }}</td>
                <td>{{ usuario.nome_usuario }}</td>
                <td>
                    <ul>
                        <li>
                            <strong>Cr칤ticas</strong>
                            <ul>
                                {% for critica in usuario.criticas %}
                                    <li>
                                        ID: {{ critica.id }} - {{ critica.titulo }}
                                        <a href="{{ url_for('admin_bp.excluir_critica', critica_id=critica.id) }}">Excluir Cr칤tica</a>
                                    </li>
                                {% else %}
                                    <li>
                                        <p>Nenhuma cr칤tica encontrada!!!</p>
                                    </li>
                                {% endfor %}
                            </ul>
                        </li>
                    </ul>
                </td>

                <td>
                    <ul>
                        <li>
                            <strong>Coment치rios</strong>
                            <ul>
                                {% for comentario in usuario.comentarios %}
                                    <li>
                                        ID: {{ comentario.id }} - {{ comentario.comentario[:30] }}
                                        <a href="{{ url_for('admin_bp.excluir_comentario', comentario_id=comentario.id) }}">Excluir Coment치rio</a>
                                    </li>
                                {% else %}
                                    <li>
                                        <p>Nenhum coment치rio encontrado</p>
                                    </li>
                                {% endfor %}
                            </ul>
                        </li>
                    </ul>
                </td>

                <td>
                    {% if usuario.is_locked %}
                        <strong style="color:red;">BLOQUEADO</strong>
                    {% else %}
                        <span style="color:green;">ATIVO</span>
                    {% endif %}
                </td>
                <td>
                    {% if usuario.is_locked %}
                        <a href="{{ url_for('admin_bp.desbloquear_usuario', user_id=usuario.id) }}">Desbloquear</a>
                    {% else %}
                        <a href="{{ url_for('admin_bp.bloquear_usuario', user_id=usuario.id) }}">Bloquear</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Links -->
<div style="margin-top: 20px;">
    <a href="{{ url_for('usuarios_bp.home') }}">游 Voltar para o site</a> |
    <a href="{{ url_for('usuarios_bp.logout') }}">游뛁 Logout</a>
</div>

{% endblock %}
